"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[32616],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=d(n),u=r,h=c["".concat(l,".").concat(u)]||c[u]||p[u]||i;return n?a.createElement(h,s(s({ref:t},m),{},{components:n})):a.createElement(h,s({ref:t},m))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:r,s[1]=o;for(var d=2;d<i;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},74155:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=n(87462),r=(n(67294),n(3905));const i={sidebar_position:7.5},s="Inserting data",o={unversionedId:"development/files-and-data/working-with-local-sql-databases-in-air/inserting-data",id:"development/files-and-data/working-with-local-sql-databases-in-air/inserting-data",title:"Inserting data",description:"Adding data to a database involves executing a SQL INSERT statement. Once the",source:"@site/docs/development/files-and-data/working-with-local-sql-databases-in-air/inserting-data.md",sourceDirName:"development/files-and-data/working-with-local-sql-databases-in-air",slug:"/development/files-and-data/working-with-local-sql-databases-in-air/inserting-data",permalink:"/docs/development/files-and-data/working-with-local-sql-databases-in-air/inserting-data",draft:!1,editUrl:"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/files-and-data/working-with-local-sql-databases-in-air/inserting-data.md",tags:[],version:"current",sidebarPosition:7.5,frontMatter:{sidebar_position:7.5},sidebar:"mainSidebar",previous:{title:"Retrieving data from a database",permalink:"/docs/development/files-and-data/working-with-local-sql-databases-in-air/retrieving-data-from-a-database"},next:{title:"Changing or deleting data",permalink:"/docs/development/files-and-data/working-with-local-sql-databases-in-air/changing-or-deleting-data"}},l={},d=[{value:"Executing an INSERT statement",id:"executing-an-insert-statement",level:2},{value:"Retrieving a database-generated primary key of an inserted row",id:"retrieving-a-database-generated-primary-key-of-an-inserted-row",level:2}],m={toc:d},c="wrapper";function p(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"inserting-data"},"Inserting data"),(0,r.kt)("p",null,"Adding data to a database involves executing a SQL ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," statement. Once the\nstatement has finished executing, you can access the primary key for the newly\ninserted row if the key was generated by the database."),(0,r.kt)("h2",{id:"executing-an-insert-statement"},"Executing an INSERT statement"),(0,r.kt)("p",null,"To add data to a table in a database, you create and execute a\n",(0,r.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLStatement.html"},"SQLStatement"),"\ninstance whose text is a SQL ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," statement."),(0,r.kt)("p",null,"The following example uses a SQLStatement instance to add a row of data to the\nalready-existing employees table. This example demonstrates inserting data using\nasynchronous execution mode. Note that this listing assumes that there is a\n",(0,r.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html"},"SQLConnection"),"\ninstance named ",(0,r.kt)("inlineCode",{parentName:"p"},"conn"),' that has already been instantiated and is already\nconnected to a database. It also assumes that the "employees" table has already\nbeen created.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'import flash.data.SQLConnection;\nimport flash.data.SQLResult;\nimport flash.data.SQLStatement;\nimport flash.events.SQLErrorEvent;\nimport flash.events.SQLEvent;\n\n// ... create and open the SQLConnection instance named conn ...\n\n// create the SQL statement\nvar insertStmt:SQLStatement = new SQLStatement();\ninsertStmt.sqlConnection = conn;\n\n// define the SQL text\nvar sql:String =\n    "INSERT INTO employees (firstName, lastName, salary) " +\n    "VALUES (\'Bob\', \'Smith\', 8000)";\ninsertStmt.text = sql;\n\n// register listeners for the result and failure (status) events\ninsertStmt.addEventListener(SQLEvent.RESULT, insertResult);\ninsertStmt.addEventListener(SQLErrorEvent.ERROR, insertError);\n\n// execute the statement\ninsertStmt.execute();\n\nfunction insertResult(event:SQLEvent):void\n{\n    trace("INSERT statement succeeded");\n}\n\nfunction insertError(event:SQLErrorEvent):void\n{\n    trace("Error message:", event.error.message);\n    trace("Details:", event.error.details);\n}\n\n<?xml version="1.0" encoding="utf-8"?>\n<mx:WindowedApplication xmlns:mx="https://www.adobe.com/2006/mxml" creationComplete="init()">\n    <mx:Script>\n        <![CDATA[\n            import flash.data.SQLConnection;\n            import flash.data.SQLResult;\n            import flash.data.SQLStatement;\n            import flash.events.SQLErrorEvent;\n            import flash.events.SQLEvent;\n\n            private function init():void\n            {\n                // ... create and open the SQLConnection instance named conn ...\n\n                // create the SQL statement\n                var insertStmt:SQLStatement = new SQLStatement();\n                insertStmt.sqlConnection = conn;\n\n                // define the SQL text\n                var sql:String =\n                    "INSERT INTO employees (firstName, lastName, salary) " +\n                    "VALUES (\'Bob\', \'Smith\', 8000)";\n                insertStmt.text = sql;\n\n                // register listeners for the result and failure (status) events\n                insertStmt.addEventListener(SQLEvent.RESULT, insertResult);\n                insertStmt.addEventListener(SQLErrorEvent.ERROR, insertError);\n\n                // execute the statement\n                insertStmt.execute();\n            }\n\n            private function insertResult(event:SQLEvent):void\n            {\n                trace("INSERT statement succeeded");\n            }\n\n            private function insertError(event:SQLErrorEvent):void\n            {\n                trace("Error message:", event.error.message);\n                trace("Details:", event.error.details);\n            }\n        ]]>\n    </mx:Script>\n</mx:WindowedApplication>\n')),(0,r.kt)("p",null,"The following example adds a row of data to the already-existing employees\ntable, using synchronous execution mode. Note that this listing assumes that\nthere is a\n",(0,r.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLConnection.html"},"SQLConnection"),"\ninstance named ",(0,r.kt)("inlineCode",{parentName:"p"},"conn"),' that has already been instantiated and is already\nconnected to a database. It also assumes that the "employees" table has already\nbeen created.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'import flash.data.SQLConnection;\nimport flash.data.SQLResult;\nimport flash.data.SQLStatement;\nimport flash.errors.SQLError;\n\n// ... create and open the SQLConnection instance named conn ...\n\n// create the SQL statement\nvar insertStmt:SQLStatement = new SQLStatement();\ninsertStmt.sqlConnection = conn;\n\n// define the SQL text\nvar sql:String =\n    "INSERT INTO employees (firstName, lastName, salary) " +\n    "VALUES (\'Bob\', \'Smith\', 8000)";\ninsertStmt.text = sql;\n\ntry\n{\n    // execute the statement\n    insertStmt.execute();\n\n    trace("INSERT statement succeeded");\n}\ncatch (error:SQLError)\n{\n    trace("Error message:", error.message);\n    trace("Details:", error.details);\n}\n\n<?xml version="1.0" encoding="utf-8"?>\n<mx:WindowedApplication xmlns:mx="https://www.adobe.com/2006/mxml" creationComplete="init()">\n    <mx:Script>\n        <![CDATA[\n            import flash.data.SQLConnection;\n            import flash.data.SQLResult;\n            import flash.data.SQLStatement;\n            import flash.errors.SQLError;\n\n            private function init():void\n            {\n                // ... create and open the SQLConnection instance named conn ...\n\n                // create the SQL statement\n                var insertStmt:SQLStatement = new SQLStatement();\n                insertStmt.sqlConnection = conn;\n\n                // define the SQL text\n                var sql:String =\n                    "INSERT INTO employees (firstName, lastName, salary) " +\n                    "VALUES (\'Bob\', \'Smith\', 8000)";\n                insertStmt.text = sql;\n\n                try\n                {\n                    // execute the statement\n                    insertStmt.execute();\n                    trace("INSERT statement succeeded");\n                }\n                catch (error:SQLError)\n                {\n                    trace("Error message:", error.message);\n                    trace("Details:", error.details);\n                }\n            }\n        ]]>\n    </mx:Script>\n</mx:WindowedApplication>\n')),(0,r.kt)("h2",{id:"retrieving-a-database-generated-primary-key-of-an-inserted-row"},"Retrieving a database-generated primary key of an inserted row"),(0,r.kt)("p",null,"Often after inserting a row of data into a table, your code needs to know a\ndatabase-generated primary key or row identifier value for the newly inserted\nrow. For example, once you insert a row in one table, you might want to add rows\nin a related table. In that case you would want to insert the primary key value\nas a foreign key in the related table. The primary key of a newly inserted row\ncan be retrieved using the\n",(0,r.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLResult.html"},"SQLResult"),"\nobject associated with the statement execution. This is the same object that's\nused to access result data after a ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT")," statement is executed. As with any\nSQL statement, when the execution of an ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," statement completes the runtime\ncreates a SQLResult instance. You access the SQLResult instance by calling the\n",(0,r.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/flash/data/SQLStatement.html"},"SQLStatement"),"\nobject's ",(0,r.kt)("inlineCode",{parentName:"p"},"getResult()")," method if you're using an event listener or if you're\nusing synchronous execution mode. Alternatively, if you're using asynchronous\nexecution mode and you pass a\n",(0,r.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/flash/net/Responder.html"},"Responder"),"\ninstance to the ",(0,r.kt)("inlineCode",{parentName:"p"},"execute()")," call, the SQLResult instance is passed as an\nargument to the result handler function. In any case, the SQLResult instance has\na property, ",(0,r.kt)("inlineCode",{parentName:"p"},"lastInsertRowID"),", that contains the row identifier of the\nmost-recently inserted row if the executed SQL statement is an ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT"),"\nstatement."),(0,r.kt)("p",null,"The following example demonstrates accessing the primary key of an inserted row\nin asynchronous execution mode:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'insertStmt.text = "INSERT INTO ...";\n\ninsertStmt.addEventListener(SQLEvent.RESULT, resultHandler);\n\ninsertStmt.execute();\n\nfunction resultHandler(event:SQLEvent):void\n{\n    // get the primary key\n    var result:SQLResult = insertStmt.getResult();\n\n    var primaryKey:Number = result.lastInsertRowID;\n    // do something with the primary key\n}\n')),(0,r.kt)("p",null,"The following example demonstrates accessing the primary key of an inserted row\nin synchronous execution mode:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'insertStmt.text = "INSERT INTO ...";\n\ntry\n{\n    insertStmt.execute();\n\n    // get the primary key\n    var result:SQLResult = insertStmt.getResult();\n\n    var primaryKey:Number = result.lastInsertRowID;\n    // do something with the primary key\n}\ncatch (error:SQLError)\n{\n/   / respond to the error\n}\n')),(0,r.kt)("p",null,"Note that the row identifier may or may not be the value of the column that is\ndesignated as the primary key column in the table definition, according to the\nfollowing rules:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"If the table is defined with a primary key column whose affinity (column data\ntype) is ",(0,r.kt)("inlineCode",{parentName:"p"},"INTEGER"),", the ",(0,r.kt)("inlineCode",{parentName:"p"},"lastInsertRowID")," property contains the value that was\ninserted into that row (or the value generated by the runtime if it's an\n",(0,r.kt)("inlineCode",{parentName:"p"},"AUTOINCREMENT")," column).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"If the table is defined with multiple primary key columns (a composite key) or\nwith a single primary key column whose affinity is not ",(0,r.kt)("inlineCode",{parentName:"p"},"INTEGER"),", behind the\nscenes the database generates an integer row identifier value for the row.\nThat generated value is the value of the ",(0,r.kt)("inlineCode",{parentName:"p"},"lastInsertRowID")," property.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The value is always the row identifier of the most-recently inserted row. If\nan ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," statement causes a trigger to fire which in turn inserts a row,\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"lastInsertRowID")," property contains the row identifier of the last row\ninserted by the trigger rather than the row created by the ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," statement."))),(0,r.kt)("p",null,"As a consequence of these rules, if you want to have an explicitly defined\nprimary key column whose value is available after an ",(0,r.kt)("inlineCode",{parentName:"p"},"INSERT")," command through\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"SQLResult.lastInsertRowID")," property, the column must be defined as an\n",(0,r.kt)("inlineCode",{parentName:"p"},"INTEGER PRIMARY KEY")," column. Even if your table does not include an explicit\n",(0,r.kt)("inlineCode",{parentName:"p"},"INTEGER PRIMARY KEY")," column, it is equally acceptable to use the\ndatabase-generated row identifier as a primary key for your table in the sense\nof defining relationships with related tables. The row identifier column value\nis available in any SQL statement by using one of the special column names\n",(0,r.kt)("inlineCode",{parentName:"p"},"ROWID"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"_ROWID_"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"OID"),". You can create a foreign key column in a related\ntable and use the row identifier value as the foreign key column value just as\nyou would with an explicitly declared ",(0,r.kt)("inlineCode",{parentName:"p"},"INTEGER PRIMARY KEY")," column. In that\nsense, if you are using an arbitrary primary key rather than a natural key, and\nas long as you don't mind the runtime generating the primary key value for you,\nit makes little difference whether you use an ",(0,r.kt)("inlineCode",{parentName:"p"},"INTEGER PRIMARY KEY")," column or\nthe system-generated row identifier as a table's primary key for defining a\nforeign key relationship with between two tables."),(0,r.kt)("p",null,"For more information about primary keys and generated row identifiers, see\n",(0,r.kt)("a",{parentName:"p",href:"/docs/development/appendixes/sql-support-in-local-databases/"},"SQL support in local databases"),"."))}p.isMDXComponent=!0}}]);