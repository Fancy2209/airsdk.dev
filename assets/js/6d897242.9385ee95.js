"use strict";(self.webpackChunkairsdk_dev=self.webpackChunkairsdk_dev||[]).push([[82797],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),u=a,h=d["".concat(l,".").concat(u)]||d[u]||m[u]||r;return n?i.createElement(h,o(o({ref:t},c),{},{components:n})):i.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,o[1]=s;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},86070:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var i=n(87462),a=(n(67294),n(3905));const r={title:"Using native JSON functionality",sidebar_position:7},o=void 0,s={unversionedId:"development/core-actionscript-classes/using-native-json-functionality",id:"development/core-actionscript-classes/using-native-json-functionality",title:"Using native JSON functionality",description:"ActionScript 3.0 provides a native API for encoding and decoding ActionScript",source:"@site/docs/development/core-actionscript-classes/using-native-json-functionality.md",sourceDirName:"development/core-actionscript-classes",slug:"/development/core-actionscript-classes/using-native-json-functionality",permalink:"/docs/development/core-actionscript-classes/using-native-json-functionality",draft:!1,editUrl:"https://github.com/airsdk/airsdk.dev/edit/main/docs/development/core-actionscript-classes/using-native-json-functionality.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Using native JSON functionality",sidebar_position:7},sidebar:"mainSidebar",previous:{title:"XML in ActionScript example - Loading RSS data from the Internet",permalink:"/docs/development/core-actionscript-classes/working-with-xml/xml-in-actionscript-example"},next:{title:"Handling Events",permalink:"/docs/development/core-actionscript-classes/handling-events/"}},l={},p=[{value:"Overview of the JSON API",id:"overview-of-the-json-api",level:2},{value:"toJSON() methods",id:"tojson-methods",level:3},{value:"Defining custom JSON behavior",id:"defining-custom-json-behavior",level:2},{value:"Defining toJSON() on the prototype of a built-in class",id:"defining-tojson-on-the-prototype-of-a-built-in-class",level:3},{value:"Defining or overriding toJSON() at the class level",id:"defining-or-overriding-tojson-at-the-class-level",level:3},{value:"Using the JSON.stringify() replacer parameter",id:"using-the-jsonstringify-replacer-parameter",level:3},{value:"Using the JSON.parse() reviver parameter",id:"using-the-jsonparse-reviver-parameter",level:3},{value:"Parsing example",id:"parsing-example",level:3}],c={toc:p},d="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(d,(0,i.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"ActionScript 3.0 provides a native API for encoding and decoding ActionScript\nobjects using JavaScript Object Notation (JSON) format. The JSON class and\nsupporting member functions follow the ECMA-262 5th edition specification with\nfew variances."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(20307).Z,width:"16",height:"16"})," Community member Todd Anderson provides a comparison\nof the native JSON API and the third-party\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/mikechambers/as3corelib"},"as3corelib")," JSON class. See\n",(0,a.kt)("a",{parentName:"p",href:"https://web.archive.org/web/20180410161903/http://blog.infrared5.com/2011/07/working-with-native-json-in-flash-player-11"},"Working with Native JSON in Flash Player 11"),"."),(0,a.kt)("h2",{id:"overview-of-the-json-api"},"Overview of the JSON API"),(0,a.kt)("p",null,"The ActionScript JSON API consists of the JSON class and ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," member\nfunctions on a few native classes. For applications that require a custom JSON\nencoding for any class, the ActionScript framework provides ways to override the\ndefault encoding."),(0,a.kt)("p",null,"The JSON class internally handles import and export for any ActionScript class\nthat does not provide a ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," member. For such cases, JSON traverses the\npublic properties of each object it encounters. If an object contains other\nobjects, JSON recurses into the nested objects and performs the same traversal.\nIf any object provides a ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," method, JSON uses that custom method instead\nof its internal algorithm."),(0,a.kt)("p",null,"The JSON interface consists of an encoding method, ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()"),", and a decoding\nmethod, ",(0,a.kt)("inlineCode",{parentName:"p"},"parse()"),". Each of these methods provides a parameter that lets you\ninsert your own logic into the JSON encoding or decoding workflow. For\n",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()"),", this parameter is named ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer"),"; for ",(0,a.kt)("inlineCode",{parentName:"p"},"parse()"),", it is\n",(0,a.kt)("inlineCode",{parentName:"p"},"reviver"),". These parameters take a function definition with two arguments using\nthe following signature:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"function(k, v):*\n")),(0,a.kt)("h3",{id:"tojson-methods"},"toJSON() methods"),(0,a.kt)("p",null,"The signature for ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," methods is"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"public function toJSON(k:String):*\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"JSON.stringify()")," calls ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),", if it exists, for each public property that\nit encounters during its traversal of an object. A property consists of a\nkey-value pair. When ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()"),") calls ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),", it passes in the key, ",(0,a.kt)("inlineCode",{parentName:"p"},"k"),",\nof the property that it is currently examining. A typical ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),"\nimplementation evaluates each property name and returns the desired encoding of\nits value."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," method can return a value of any type (denoted as ","*",")\u2014not just a\nString. This variable return type allows ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," to return an object if\nappropriate. For example, if a property of your custom class contains an object\nfrom another third-party library, you can return that object when ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),"\nencounters your property. JSON then recurses into the third-party object. The\nencoding process flow behaves as follows:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"If ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," returns an object that doesn't evaluate to a string,\n",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," recurses into that object.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"If ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," returns a string, ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," wraps that value in another\nstring, returns the wrapped string, and then moves to the next value."))),(0,a.kt)("p",null,"In many cases, returning an object is preferable to returning a JSON string\ncreated by your application. Returning an object takes leverages the built-in\nJSON encoding algorithm and also allows JSON to recurse into nested objects."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," method is not defined in the Object class or in most other native\nclasses. Its absence tells JSON to perform its standard traversal over the\nobject's public properties. If you like, you can also use ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," to expose\nyour object's private properties."),(0,a.kt)("p",null,"A few native classes pose challenges that the ActionScript libraries can't solve\neffectively for all use cases. For these classes, ActionScript provides a\ntrivial implementation that clients can reimplement to suit their needs. The\nclasses that provide trivial ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," members include:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"ByteArray")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Date")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Dictionary")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"XML"))),(0,a.kt)("p",null,"You can subclass the ByteArray class to override its ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," method, or you\ncan redefine its prototype. The Date and XML classes, which are declared final,\nrequire you to use the class prototype to redefine ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),". The Dictionary\nclass is declared dynamic, which gives you extra freedom in overriding\n",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),"."),(0,a.kt)("h2",{id:"defining-custom-json-behavior"},"Defining custom JSON behavior"),(0,a.kt)("p",null,"To implement your own JSON encoding and decoding for native classes, you can\nchoose from several options:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Defining or overriding ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," on your custom subclass of a non-final\nnative class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Defining or redefining ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," on the class prototype")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Defining a ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON")," property on a dynamic class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Using the ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.stringify() replacer")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.parser() reviver")," parameters"))),(0,a.kt)("h3",{id:"defining-tojson-on-the-prototype-of-a-built-in-class"},"Defining toJSON() on the prototype of a built-in class"),(0,a.kt)("p",null,"The native JSON implementation in ActionScript mirrors the ECMAScript JSON\nmechanism defined in ECMA-262, 5th edition. Since ECMAScript doesn't support\nclasses, ActionScript defines JSON behavior in terms of prototype-based\ndispatch. Prototypes are precursors to ActionScript 3.0 classes that allow\nsimulated inheritance as well as member additions and redefinitions."),(0,a.kt)("p",null,"ActionScript allows you to define or redefine ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," on the prototype of any\nclass. This privilege applies even to classes that are marked final. When you\ndefine ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," on a class prototype, your definition becomes current for all\ninstances of that class within the scope of your application. For example,\nhere's how you can define a ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," method on the MovieClip prototype:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'MovieClip.prototype.toJSON = function(k):* {\n    trace("prototype.toJSON() called.");\n    return "toJSON";\n}\n')),(0,a.kt)("p",null,"When your application then calls ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," on any MovieClip instance,\n",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," returns the output of your ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," method:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'var mc:MovieClip = new MovieClip();\nvar js:String = JSON.stringify(mc); //"prototype toJSON() called."\ntrace("js: " + js); //"js: toJSON"\n')),(0,a.kt)("p",null,"You can also override ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," in native classes that define the method. For\nexample, the following code overrides ",(0,a.kt)("inlineCode",{parentName:"p"},"Date.toJSON()"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'Date.prototype.toJSON = function (k):* {\n    return "any date format you like via toJSON: "+\n        "this.time:"+this.time + " this.hours:"+this.hours;\n}\nvar dt:Date = new Date();\ntrace(JSON.stringify(dt));\n// "any date format you like via toJSON: this.time:1317244361947 this.hours:14"\n')),(0,a.kt)("h3",{id:"defining-or-overriding-tojson-at-the-class-level"},"Defining or overriding toJSON() at the class level"),(0,a.kt)("p",null,"Applications aren't always required to use prototypes to redefine ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),".\nYou can also define ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," as a member of a subclass if the parent class is\nnot marked final. For example, you can extend the ByteArray class and define a\npublic ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," function:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'package\n{\n    import flash.utils.ByteArray;\n    public class MyByteArray extends ByteArray\n    {\n        public function MyByteArray() {\n        }\n\n        public function toJSON(s:String):*\n        {\n            return "MyByteArray";\n        }\n\n    }\n}\n\n\nvar ba:ByteArray = new ByteArray();\ntrace(JSON.stringify(ba)); //"ByteArray"\nvar mba:MyByteArray = new MyByteArray(); //"MyByteArray"\ntrace(JSON.stringify(mba)); //"MyByteArray"\n')),(0,a.kt)("p",null,"If a class is dynamic, you can add a ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON")," property to an object of that\nclass and assign a function to it as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'var d:Dictionary = new Dictionary();\ntrace(JSON.stringify((d))); // "Dictionary"\nd.toJSON = function(){return {c : "toJSON override."};} // overrides existing function\ntrace(JSON.stringify((d))); // {"c":"toJSON override."}\n')),(0,a.kt)("p",null,"You can override, define, or redefine ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," on any ActionScript class.\nHowever, most built-in ActionScript classes don't define ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),". The Object\nclass does not define ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON")," in its default prototype or declare it as a class\nmember. Only a handful of native classes define the method as a prototype\nfunction. Thus, in most classes you can't override ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," in the traditional\nsense."),(0,a.kt)("p",null,"Native classes that don't define ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," are serialized to JSON by the\ninternal JSON implementation. Avoid replacing this built-in functionality if\npossible. If you define a ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," member, the JSON class uses your logic\ninstead of its own functionality."),(0,a.kt)("h3",{id:"using-the-jsonstringify-replacer-parameter"},"Using the JSON.stringify() replacer parameter"),(0,a.kt)("p",null,"Overriding ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," on the prototype is useful for changing a class's JSON\nexport behavior throughout an application. In some cases, though, your export\nlogic might apply only to special cases under transient conditions. To\naccommodate such small-scope changes, you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," parameter of\nthe ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.stringify()")," method."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," method applies the function passed through the ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer"),"\nparameter to the object being encoded. The signature for this function is\nsimilar to that of ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"function (k,v):*\n")),(0,a.kt)("p",null,"Unlike ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),", the ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," function requires the value, ",(0,a.kt)("inlineCode",{parentName:"p"},"v"),", as well as\nthe key, ",(0,a.kt)("inlineCode",{parentName:"p"},"k"),". This difference is necessary because ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," is defined on\nthe static JSON object instead of the object being encoded. When\n",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.stringify()")," calls ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer(k,v)"),", it is traversing the original input\nobject. The implicit ",(0,a.kt)("inlineCode",{parentName:"p"},"this")," parameter passed to the ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," function refers\nto the object that holds the key and value. Because ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.stringify()")," does not\nmodify the original input object, that object remains unchanged in the container\nbeing traversed. Thus, you can use the code ",(0,a.kt)("inlineCode",{parentName:"p"},"this[k]")," to query the key on the\noriginal object. The ",(0,a.kt)("inlineCode",{parentName:"p"},"v")," parameter holds the value that ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()")," converts."),(0,a.kt)("p",null,"Like ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),", the ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," function can return any type of value. If\n",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," returns a string, the JSON engine escapes the contents in quotes and\nthen wraps those escaped contents in quotes as well. This wrapping guarantees\nthat ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()")," receives a valid JSON string object that remains a string in\na subsequent call to ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.parse()"),"."),(0,a.kt)("p",null,"The following code uses the ",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," parameter and the implicit ",(0,a.kt)("inlineCode",{parentName:"p"},"this"),"\nparameter to return the ",(0,a.kt)("inlineCode",{parentName:"p"},"time")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"hours")," values of a Date object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'JSON.stringify(d, function (k,v):* {\n    return "any date format you like via replacer: "+\n        "holder[k].time:"+this[k].time + " holder[k].hours:"+this[k].hours;\n});\n')),(0,a.kt)("h3",{id:"using-the-jsonparse-reviver-parameter"},"Using the JSON.parse() reviver parameter"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"reviver")," parameter of the ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.parse()")," method does the opposite of the\n",(0,a.kt)("inlineCode",{parentName:"p"},"replacer")," function: It converts a JSON string into a usable ActionScript\nobject. The ",(0,a.kt)("inlineCode",{parentName:"p"},"reviver")," argument is a function that takes two parameters and\nreturns any type:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"function (k,v):*\n")),(0,a.kt)("p",null,"In this function, ",(0,a.kt)("inlineCode",{parentName:"p"},"k")," is a key, and ",(0,a.kt)("inlineCode",{parentName:"p"},"v")," is the value of ",(0,a.kt)("inlineCode",{parentName:"p"},"k"),". Like ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify()"),",\n",(0,a.kt)("inlineCode",{parentName:"p"},"parse()")," traverses the JSON key-value pairs and applies the ",(0,a.kt)("inlineCode",{parentName:"p"},"reviver"),"\nfunction\u2014if one exists\u2014to each pair. A potential problem is the fact that the\nJSON class does not output an object's ActionScript class name. Thus, it can be\nchallenging to know which type of object to revive. This problem can be\nespecially troublesome when objects are nested. In designing ",(0,a.kt)("inlineCode",{parentName:"p"},"toJSON()"),",\n",(0,a.kt)("inlineCode",{parentName:"p"},"replacer"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"reviver")," functions, you can devise ways to identify the\nActionScript objects that are exported while keeping the original objects\nintact."),(0,a.kt)("h3",{id:"parsing-example"},"Parsing example"),(0,a.kt)("p",null,"The following example shows a strategy for reviving objects parsed from JSON\nstrings. This example defines two classes: JSONGenericDictExample and\nJSONDictionaryExtnExample. Class JSONGenericDictExample is a custom dictionary\nclass. Each record contains a person's name and birthday, as well as a unique\nID. Each time the JSONGenericDictExample constructor is called, it adds the\nnewly created object to an internal static array with a statically incrementing\ninteger as its ID. Class JSONGenericDictExample also defines a ",(0,a.kt)("inlineCode",{parentName:"p"},"revive()")," method\nthat extracts just the integer portion from the longer ",(0,a.kt)("inlineCode",{parentName:"p"},"id")," member. The\n",(0,a.kt)("inlineCode",{parentName:"p"},"revive()")," method uses this integer to look up and return the correct revivable\nobject."),(0,a.kt)("p",null,"Class JSONDictionaryExtnExample extends the ActionScript Dictionary class. Its\nrecords have no set structure and can contain any data. Data is assigned after a\nJSONDictionaryExtnExample object is constructed, rather than as class-defined\nproperties. JSONDictionaryExtnExample records use JSONGenericDictExample objects\nas keys. When a JSONDictionaryExtnExample object is revived, the\n",(0,a.kt)("inlineCode",{parentName:"p"},"JSONGenericDictExample.revive()")," function uses the ID associated with\nJSONDictionaryExtnExample to retrieve the correct key object."),(0,a.kt)("p",null,"Most importantly, the ",(0,a.kt)("inlineCode",{parentName:"p"},"JSONDictionaryExtnExample.toJSON()")," method returns a\nmarker string in addition to the JSONDictionaryExtnExample object. This string\nidentifies the JSON output as belonging to the JSONDictionaryExtnExample class.\nThis marker leaves no doubt as to which object type is being processed during\n",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.parse()"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'package {\n    // Generic dictionary example:\n    public class JSONGenericDictExample {\n        static var revivableObjects = [];\n        static var nextId = 10000;\n        public var id;\n        public var dname:String;\n        public var birthday;\n\n        public function JSONGenericDictExample(name, birthday) {\n            revivableObjects[nextId] = this;\n            this.id       = "id_class_JSONGenericDictExample_" + nextId;\n            this.dname     = name;\n            this.birthday = birthday;\n            nextId++;\n        }\n        public function toString():String { return this.dname; }\n        public static function revive(id:String):JSONGenericDictExample {\n            var r:RegExp = /^id_class_JSONGenericDictExample_([0-9]*)$/;\n            var res = r.exec(id);\n            return JSONGenericDictExample.revivableObjects[res[1]];\n        }\n    }\n}\n\npackage {\n    import flash.utils.Dictionary;\n    import flash.utils.ByteArray;\n\n    // For this extension of dictionary, we serialize the contents of the\n    // dictionary by using toJSON\n    public final class JSONDictionaryExtnExample extends Dictionary {\n        public function toJSON(k):* {\n            var contents = {};\n            for (var a in this) {\n                contents[a.id] = this[a];\n            }\n\n            // We also wrap the contents in an object so that we can\n            // identify it by looking for the marking property "class E"\n            // while in the midst of JSON.parse.\n            return {"class JSONDictionaryExtnExample": contents};\n        }\n\n        // This is just here for debugging and for illustration\n        public function toString():String {\n            var retval = "[JSONDictionaryExtnExample <";\n            var printed_any = false;\n            for (var k in this) {\n                retval += k.toString() + "=" +\n                "[e="+this[k].earnings +\n                ",v="+this[k].violations + "], "\n                printed_any = true;\n            }\n            if (printed_any)\n                retval = retval.substring(0, retval.length-2);\n            retval += ">]"\n            return retval;\n        }\n    }\n}\n')),(0,a.kt)("p",null,"When the following runtime script calls ",(0,a.kt)("inlineCode",{parentName:"p"},"JSON.parse()")," on a\nJSONDictionaryExtnExample object, the ",(0,a.kt)("inlineCode",{parentName:"p"},"reviver")," function calls\n",(0,a.kt)("inlineCode",{parentName:"p"},"JSONGenericDictExample.revive()")," on each object in JSONDictionaryExtnExample.\nThis call extracts the ID that represents the object key. The\n",(0,a.kt)("inlineCode",{parentName:"p"},"JSONGenericDictExample.revive()")," function uses this ID to retrieve and return\nthe stored JSONDictionaryExtnExample object from a private static array."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'import flash.display.MovieClip;\nimport flash.text.TextField;\n\nvar a_bob1:JSONGenericDictExample = new JSONGenericDictExample("Bob", new Date(Date.parse("01/02/1934")));\nvar a_bob2:JSONGenericDictExample = new JSONGenericDictExample("Bob", new Date(Date.parse("05/06/1978")));\nvar a_jen:JSONGenericDictExample = new JSONGenericDictExample("Jen", new Date(Date.parse("09/09/1999")));\n\nvar e = new JSONDictionaryExtnExample();\ne[a_bob1] = {earnings: 40, violations: 2};\ne[a_bob2] = {earnings: 10, violations: 1};\ne[a_jen]  = {earnings: 25, violations: 3};\n\ntrace("JSON.stringify(e): " + JSON.stringify(e)); // {"class JSONDictionaryExtnExample":\n                        //{"id_class_JSONGenericDictExample_10001":\n                        //{"earnings":10,"violations":1},\n                        //"id_class_JSONGenericDictExample_10002":\n                        //{"earnings":25,"violations":3},\n                        //"id_class_JSONGenericDictExample_10000":\n                        // {"earnings":40,"violations":2}}}\n\nvar e_result = JSON.stringify(e);\n\nvar e1 = new JSONDictionaryExtnExample();\nvar e2 = new JSONDictionaryExtnExample();\n\n// It\'s somewhat easy to convert the string from JSON.stringify(e) back\n// into a dictionary (turn it into an object via JSON.parse, then loop\n// over that object\'s properties to construct a fresh dictionary).\n//\n// The harder exercise is to handle situations where the dictionaries\n// themselves are nested in the object passed to JSON.stringify and\n// thus does not occur at the topmost level of the resulting string.\n//\n// (For example: consider roundtripping something like\n//   var tricky_array = [e1, [[4, e2, 6]], {table:e3}]\n// where e1, e2, e3 are all dictionaries.  Furthermore, consider\n// dictionaries that contain references to dictionaries.)\n//\n// This parsing (or at least some instances of it) can be done via\n// JSON.parse, but it\'s not necessarily trivial.  Careful consideration\n// of how toJSON, replacer, and reviver can work together is\n// necessary.\n\nvar e_roundtrip =\n    JSON.parse(e_result,\n               // This is a reviver that is focused on rebuilding JSONDictionaryExtnExample objects.\n               function (k, v) {\n                    if ("class JSONDictionaryExtnExample" in v) { // special marker tag;\n                        //see JSONDictionaryExtnExample.toJSON().\n                       var e = new JSONDictionaryExtnExample();\n                       var contents = v["class JSONDictionaryExtnExample"];\n                       for (var i in contents) {\n                          // Reviving JSONGenericDictExample objects from string\n                          // identifiers is also special;\n                          // see JSONGenericDictExample constructor and\n                          // JSONGenericDictExample\'s revive() method.\n                           e[JSONGenericDictExample.revive(i)] = contents[i];\n                       }\n                       return e;\n                   } else {\n                       return v;\n                   }\n               });\n\ntrace("// == Here is an extended Dictionary that has been round-tripped  ==");\ntrace("// == Note that we have revived Jen/Jan during the roundtrip.    ==");\ntrace("e:           " + e); //[JSONDictionaryExtnExample <Bob=[e=40,v=2], Bob=[e=10,v=1],\n                           //Jen=[e=25,v=3]>]\ntrace("e_roundtrip: " + e_roundtrip); //[JSONDictionaryExtnExample <Bob=[e=40,v=2],\n                                     //Bob=[e=10,v=1], Jen=[e=25,v=3]>]\ntrace("Is e_roundtrip a JSONDictionaryExtnExample? " + (e_roundtrip is JSONDictionaryExtnExample)); //true\ntrace("Name change: Jen is now Jan");\na_jen.dname = "Jan"\n\ntrace("e:           " + e); //[JSONDictionaryExtnExample <Bob=[e=40,v=2], Bob=[e=10,v=1],\n                           //Jan=[e=25,v=3]>]\ntrace("e_roundtrip: " + e_roundtrip); //[JSONDictionaryExtnExample <Bob=[e=40,v=2],\n                                     //Bob=[e=10,v=1], Jan=[e=25,v=3]>]\n')),(0,a.kt)("p",null,"More Help topics"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(67824).Z,width:"16",height:"16"}),"\n",(0,a.kt)("a",{parentName:"p",href:"https://airsdk.dev/reference/actionscript/3.0/JSON.html"},"JSON class")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://web.archive.org/web/20151029173219/http://help.adobe.com/en_US/as3/learn/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f3f.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7fa3"},"The prototype object")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.ecma-international.org/publications-and-standards/standards/ecma-262/"},"ECMA-262 specification")))}m.isMDXComponent=!0},20307:(e,t,n)=>{n.d(t,{Z:()=>i});const i="data:image/png;base64,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"},67824:(e,t,n)=>{n.d(t,{Z:()=>i});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUwMDZGOTY2NjYxRjExRTBCNDdCQTM5RjAzRkM2RTA1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUwMDZGOTY3NjYxRjExRTBCNDdCQTM5RjAzRkM2RTA1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTAwNkY5NjQ2NjFGMTFFMEI0N0JBMzlGMDNGQzZFMDUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTAwNkY5NjU2NjFGMTFFMEI0N0JBMzlGMDNGQzZFMDUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6HYd/mAAABZUlEQVR42oxSOU7EUAy1ZyKQ0o1EkQKJAgrSoKkoOAASHXfgULSUdJyAQ+QII+UMkGSSb7z9JYyQ+JJjO96fjZ+P93T3dAUX1zuALYK+hQBCYL44ZwqL6U748qHO+HZ5QyI9nB1EBWSFiJijcv9hiUE813K1gFWd1ImJ3Cn6eTC5PSZGJDVVx8AKGybC5ChOp8//keVEsETV7AEDz2lxbJC5YxjmduNEqlOwDmb5yTQKgKltEzFWLjGw8knmESxi1A5y6zaKFKLcGbkP28irVLOXHckMMYlh5j1Q0Ujqxh6PYJZpQwnpvKVijSXPqPgWWBsEuDQ4f0IMCq6HQs9Y6RZkzkERL4AElwk9r+8fMJ8SxjtgadQCtNpCuf4C3TUGR2932uYjyfu3jpNMp+dVzcHKfC1F4OoO/n7is3l+f4Xz/S2vEZQGTjhE+Rd9hzUf4031fU9d18F/X13X0DQNtG2LPwIMALHE9dBufo94AAAAAElFTkSuQmCC"}}]);